<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Validation | Carolina Documentation</title>
    <meta name="description" content="Documentation for the Carolina web framework.">
    
    
    <link rel="preload" href="/assets/css/styles.1d2d3735.css" as="style"><link rel="preload" href="/assets/js/app.1d2d3735.js" as="script"><link rel="preload" href="/assets/js/26.0d288857.js" as="script"><link rel="prefetch" href="/assets/js/1.f05c9cba.js"><link rel="prefetch" href="/assets/js/10.bac22d9b.js"><link rel="prefetch" href="/assets/js/11.3d8fb5fe.js"><link rel="prefetch" href="/assets/js/12.15d64a99.js"><link rel="prefetch" href="/assets/js/13.025e71f2.js"><link rel="prefetch" href="/assets/js/14.fd7a08c1.js"><link rel="prefetch" href="/assets/js/15.e1bc1756.js"><link rel="prefetch" href="/assets/js/16.5770cf46.js"><link rel="prefetch" href="/assets/js/17.853ce496.js"><link rel="prefetch" href="/assets/js/18.971e2150.js"><link rel="prefetch" href="/assets/js/19.c761800c.js"><link rel="prefetch" href="/assets/js/2.988f372d.js"><link rel="prefetch" href="/assets/js/20.4e4bef1c.js"><link rel="prefetch" href="/assets/js/21.b3aaaedf.js"><link rel="prefetch" href="/assets/js/22.1bb76f3c.js"><link rel="prefetch" href="/assets/js/23.3d27ba26.js"><link rel="prefetch" href="/assets/js/24.0bac6e09.js"><link rel="prefetch" href="/assets/js/25.c2b28b9a.js"><link rel="prefetch" href="/assets/js/27.98f9eff3.js"><link rel="prefetch" href="/assets/js/28.26974ced.js"><link rel="prefetch" href="/assets/js/29.6b34c182.js"><link rel="prefetch" href="/assets/js/3.8f49772c.js"><link rel="prefetch" href="/assets/js/30.3e9f8855.js"><link rel="prefetch" href="/assets/js/31.f88a0e4e.js"><link rel="prefetch" href="/assets/js/32.cd87dfeb.js"><link rel="prefetch" href="/assets/js/33.b61fa559.js"><link rel="prefetch" href="/assets/js/34.c116294f.js"><link rel="prefetch" href="/assets/js/35.2f210b65.js"><link rel="prefetch" href="/assets/js/36.cb8e5677.js"><link rel="prefetch" href="/assets/js/37.0de8ac6f.js"><link rel="prefetch" href="/assets/js/38.cb46e1ce.js"><link rel="prefetch" href="/assets/js/39.b4986129.js"><link rel="prefetch" href="/assets/js/4.6855463a.js"><link rel="prefetch" href="/assets/js/40.a060c3fb.js"><link rel="prefetch" href="/assets/js/41.e48da89d.js"><link rel="prefetch" href="/assets/js/42.3cf3cf2d.js"><link rel="prefetch" href="/assets/js/43.74393af5.js"><link rel="prefetch" href="/assets/js/44.9d05ba51.js"><link rel="prefetch" href="/assets/js/5.00dd7cd0.js"><link rel="prefetch" href="/assets/js/6.9ca81a96.js"><link rel="prefetch" href="/assets/js/7.24dcfe4e.js"><link rel="prefetch" href="/assets/js/8.f67b2fab.js"><link rel="prefetch" href="/assets/js/9.85b5be06.js">
    <link rel="stylesheet" href="/assets/css/styles.1d2d3735.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Carolina Documentation
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Getting Started</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Framework Overview</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Basics</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/docs/basics/routing.html" class="sidebar-link">Routing</a></li><li><a href="/docs/basics/middleware.html" class="sidebar-link">Middleware</a></li><li><a href="/docs/basics/csrf.html" class="sidebar-link">CSRF Tokens </a></li><li><a href="/docs/basics/controllers.html" class="sidebar-link">Controller Classes</a></li><li><a href="/docs/basics/requests.html" class="sidebar-link">HTTP Request Objects</a></li><li><a href="/docs/basics/responses.html" class="sidebar-link">HTTP Response Objects</a></li><li><a href="/docs/basics/template-views.html" class="sidebar-link">Template Views</a></li><li><a href="/docs/basics/session.html" class="sidebar-link">Session</a></li><li><a href="/docs/basics/validation.html" class="active sidebar-link">Validation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/basics/validation.html#basic-validation" class="sidebar-link">Basic Validation</a></li><li class="sidebar-sub-header"><a href="/docs/basics/validation.html#displaying-validation-errors" class="sidebar-link">Displaying Validation Errors</a></li><li class="sidebar-sub-header"><a href="/docs/basics/validation.html#useful-field-configuration" class="sidebar-link">Useful Field Configuration</a></li><li class="sidebar-sub-header"><a href="/docs/basics/validation.html#schema-rules" class="sidebar-link">Schema Rules</a></li></ul></li><li><a href="/docs/basics/errors.html" class="sidebar-link">Exceptions</a></li><li><a href="/docs/basics/logging.html" class="sidebar-link">Logging</a></li><li><a href="/docs/basics/pug.html" class="sidebar-link">Pug Templates</a></li><li><a href="/docs/basics/crypto.html" class="sidebar-link">The Crypto Service</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Authentication</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Advanced</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Databases</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Included Plugins</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="validation"><a href="#validation" aria-hidden="true" class="header-anchor">#</a> Validation</h1><p>Carolina has a built-in way to validate user input or other objects, and it is
related to the system for database models and schemas.</p><p>The Database system uses models and schema objects to represent database
entries, but schemas can be used independently of database models for the
purposes of validation.</p><p>For more on schemas in the context of database models, see the docs on
<a href="/db/models.html">Schemas &amp; Models</a>.</p><h2 id="basic-validation"><a href="#basic-validation" aria-hidden="true" class="header-anchor">#</a> Basic Validation</h2><h3 id="controller-method"><a href="#controller-method" aria-hidden="true" class="header-anchor">#</a> Controller Method</h3><p>You can use validation inside your controllers with the controllers
<code>_validate</code> method.</p><p>Its usage looks like this:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
  <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_validate</span><span class="token punctuation">(</span><span class="token string">&quot;MySchema&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The first argument is the name of a validation schema - an object type of the
Validation Service. The second argument is the data to validate. The third
argument is whether or not a <code>ValidationError</code> should be thrown if validation
fails. If the third argument is omitted or set to false, an object describing
the validation failure will returned if validation fails. An object
like <code>{ success: true }</code> will be returned in either case if validation
passes.</p><h3 id="writing-validation-schemas"><a href="#writing-validation-schemas" aria-hidden="true" class="header-anchor">#</a> Writing Validation Schemas</h3><p>Validation schemas are special objects managed by the Validation Service.
The Service defines a few of its own schemas, including &quot;LoginSchema&quot; and
&quot;RegisterSchema&quot;, but will also look in installed plugins and in your
projects <code>site/</code> directory under <code>validation/schemas/index.js</code>.</p><p>An example <code>site/validation/schemas/index.js</code> might look like this:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * Export validation schemas here.
 */</span>
exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  TestSchema<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./test-schema'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>test-schema.js</code> file should look like this:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> BaseSchema <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'carolina/main/db/schemas/base-schema'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">TestSchema</span> <span class="token keyword">extends</span> <span class="token class-name">BaseSchema</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    <span class="token comment">// no auto date fields</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'String'</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> TestSchema<span class="token punctuation">;</span>
</code></pre></div><p>The simple schema defined there declares that object <em>must</em> have the property
<code>name</code>, which should match the String field type.</p><p>When validating, an object like <code>{ level: 10 }</code> would fail according to
this schema but <code>{ level: 10, name: &quot;Some Name&quot; }</code> would pass.</p><p>More details on the options available for schemas are further down in this page
as well as on the docs on
<a href="/db/models.html">Schemas &amp; Models</a>.</p><p>Note that validation errors will only give 1 error message, although there
may be more than one problem. The Validation Service immediately stops
checking after the first error.</p><p>In addition to applying field constraints, you can specify rules that apply
to the entire object. Rules are checked after each field is individually
verified.</p><p>For example, the following rule asserts that a given object will provide
<code>primaryPhone</code> and <code>secondaryPhone</code> and that they will not be the same:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>primaryPhone <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'String'</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>secondaryPhone <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'String'</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">this</span><span class="token punctuation">.</span>rules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  rule<span class="token punctuation">:</span> <span class="token string">'Distinct'</span><span class="token punctuation">,</span>
  fields<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'primaryPhone'</span><span class="token punctuation">,</span> <span class="token string">'secondaryPhone'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="displaying-validation-errors"><a href="#displaying-validation-errors" aria-hidden="true" class="header-anchor">#</a> Displaying Validation Errors</h2><p>You have a few options for showing validation failures to the client.</p><p>In many cases you should not tell the <code>_validate</code> method to throw an error,
and instead capture the response as a variable and use the <code>message</code>
attribute.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_validate</span><span class="token punctuation">(</span><span class="token string">'SomeSchema'</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>val<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The error message.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you are returning a response directly in case of a validation failure,
you are responsible for rendering the error message, perhaps by passing it
to a template.</p><p>If you are doing a redirect, you can flash the error to the session.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_validate</span><span class="token punctuation">(</span><span class="token string">'SomeSchema'</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>data<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>val<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token string">&quot;/original-form&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">flash</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>message<span class="token punctuation">,</span> <span class="token string">&quot;Uh-oh!&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;danger&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> res<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>For more on flashing messages to the session, see the
<a href="/basics/session.html">Session docs</a>.</p><p>If you throw an error from the <code>_validate</code> method, the returned response with
be a formatted Carolina error page or a JSON describing the errors.
If <code>app.debug</code> in config is set to true, the response will contain many
application details. Otherwise, they will be simple responses with minimal
information.</p><p>Most errors thrown and uncaught in the request cycle will return a 500 status
code, but Validation errors will return a 400 status code instead.</p><h2 id="useful-field-configuration"><a href="#useful-field-configuration" aria-hidden="true" class="header-anchor">#</a> Useful Field Configuration</h2><p>Schemas are better documented in the docs on
<a href="/db/models.html">Schemas &amp; Models</a>, but here are some basics on the
helpful properties of schema fields when it comes to validation.</p><p><strong><code>min</code> and <code>max</code></strong></p><p>Applies to numeric and date fields.</p><p>Also applies to string fields, but in a different way.</p><p>Forces the property to be greater than <code>min</code> if provided and/or less than
<code>max</code> if provided.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// date must be at or after December 21, 2012</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>recentDate <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'Date'</span><span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token string">&quot;2012-12-21&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// number must be an integer between 1 and 10 (inclusive)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>chosenNumber <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'Integer'</span><span class="token punctuation">,</span> min<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> max<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>For strings, the property is enforced to be at least <code>min</code> characters in
length and at most <code>max</code> characters.</p><p><strong><code>regex</code></strong></p><p>Applies to &quot;String&quot; fields. Forces the property value to match a certain
regular expression object.</p><p><strong><code>requireTrue</code></strong></p><p>Only applies to <code>BooleanField</code> (&quot;Boolean&quot;).</p><p>Forces the property to both exist and be true.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>acceptTermsAndConditions <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'Boolean'</span><span class="token punctuation">,</span> requireTrue<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong><code>type</code></strong></p><p>Many field types force the property to be of that type.</p><p>Examples include: &quot;String&quot;, &quot;Number&quot;, &quot;Array&quot;, &quot;Object&quot;, &quot;Boolean&quot;</p><h2 id="schema-rules"><a href="#schema-rules" aria-hidden="true" class="header-anchor">#</a> Schema Rules</h2><p>Schemas can also include rules. Rules are objects, managed by the Validation
Service, that enforce certain things about an object, taking the entire object
into account.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">CustomSchema</span> <span class="token keyword">extends</span> <span class="token class-name">BaseSchema</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'String'</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fields<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'String'</span><span class="token punctuation">,</span> required<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token keyword">this</span><span class="token punctuation">.</span>rules <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> rule<span class="token punctuation">:</span> <span class="token string">'DistinctRule'</span><span class="token punctuation">,</span> config<span class="token punctuation">:</span> <span class="token punctuation">{</span> fields<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The added rule tells the Validation Service to enforce the values of properties
&quot;a&quot; and &quot;b&quot; are not the same as each other.</p><p>Every Rule in <code>this.rules</code> must have a rule name (as <code>rule</code>) and a config object.
The contents of the latter depend on the specific rule. In the case of
<code>DistictRule</code>, the <code>fields</code> property of the config object lists the fields
that must be distinct.</p><h3 id="included-rules"><a href="#included-rules" aria-hidden="true" class="header-anchor">#</a> Included Rules</h3><p>Here is a list of included Rules:</p><p><strong><code>DistinctRule</code></strong></p><p>Enforces that certain fields have distinct values. The config object should
have a <code>fields</code> property which should be a list of fields that must be
distinct.</p><p><strong><code>SamenessRule</code></strong></p><p>Enforces that certain files have the same value. The config object should
have a <code>fields</code> property which should be a list of fields that must have
the same value.</p><h3 id="custom-rules"><a href="#custom-rules" aria-hidden="true" class="header-anchor">#</a> Custom Rules</h3><p>You can make your own rules to then include in Schemas. You can generate
a new Rule class via the CLI:</p><div class="language- extra-class"><pre class="language-text"><code>node . generate rule ExampleRule
</code></pre></div><p>This would create the file
<code>site/validation/rules/example-rule.js</code>.</p><p>A rule has one critical method, <code>validate()</code>. It takes a config that
may provided details about the rule should be enforced as the first argument
and as the second argument it takes the object to be validated.
The method should return an object with a boolean <code>success</code> property,
specifying whether or not validation passes this rule. If <code>success</code> is
<code>false</code>, a <code>message</code> property should also be included.</p><p>Example Rule (the sameness rule):</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">const</span> BaseRule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'carolina/main/validation/rules/base-rule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Rule SamenessRule
 * Enforces that the given properties have the same value.
 */</span>
<span class="token keyword">class</span> <span class="token class-name">SamenessRule</span> <span class="token keyword">extends</span> <span class="token class-name">BaseRule</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">validate</span><span class="token punctuation">(</span><span class="token parameter">config<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// console.log(&quot;SamenessRule.validate&quot;);</span>

    <span class="token comment">// set val to the first field's value</span>
    <span class="token keyword">let</span> val <span class="token operator">=</span> obj<span class="token punctuation">[</span>config<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> config<span class="token punctuation">.</span>fields<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// if a value is not the same, fail validation</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>config<span class="token punctuation">.</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">!=</span> val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          success<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          message<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>fields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> does not have the same value as </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>config<span class="token punctuation">.</span>fields<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span> success<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> SamenessRule<span class="token punctuation">;</span>
</code></pre></div><p>If would be up to you to expose the class by name via
<code>site/validation/rules/index.js</code>:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  SamenessRule<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./sameness-rule'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><code>SamenessRule</code> is already included in the Carolina framework, but if you did
this same thing with <code>ExampleRule</code>, you would be able to reference
<code>ExampleRule</code> in Schemas. You should document what kind of object
you expect for the <code>config</code> somewhere.</p></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/basics/session.html" class="prev">
          Session
        </a></span><span class="next"><a href="/docs/basics/errors.html">
          Exceptions
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/app.1d2d3735.js" defer></script><script src="/assets/js/26.0d288857.js" defer></script>
  </body>
</html>
