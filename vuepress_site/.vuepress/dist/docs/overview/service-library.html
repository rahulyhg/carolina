<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Carolina Global Object | Carolina Documentation</title>
    <meta name="description" content="Documentation for the Carolina web framework.">
    
    
    <link rel="preload" href="/assets/css/styles.4c99cee3.css" as="style"><link rel="preload" href="/assets/js/app.4c99cee3.js" as="script"><link rel="preload" href="/assets/js/38.8ff035ad.js" as="script"><link rel="prefetch" href="/assets/js/1.1cf9f1db.js"><link rel="prefetch" href="/assets/js/10.67736b9c.js"><link rel="prefetch" href="/assets/js/11.7beeac27.js"><link rel="prefetch" href="/assets/js/12.8ffce904.js"><link rel="prefetch" href="/assets/js/13.54a86374.js"><link rel="prefetch" href="/assets/js/14.f6222131.js"><link rel="prefetch" href="/assets/js/15.60843f1a.js"><link rel="prefetch" href="/assets/js/16.3bab9827.js"><link rel="prefetch" href="/assets/js/17.371a0e2c.js"><link rel="prefetch" href="/assets/js/18.2bf4752f.js"><link rel="prefetch" href="/assets/js/19.d7b2b433.js"><link rel="prefetch" href="/assets/js/2.d296c8c8.js"><link rel="prefetch" href="/assets/js/20.84f7874a.js"><link rel="prefetch" href="/assets/js/21.b063a67b.js"><link rel="prefetch" href="/assets/js/22.75e8e46c.js"><link rel="prefetch" href="/assets/js/23.c3543ea8.js"><link rel="prefetch" href="/assets/js/24.5c5f18c8.js"><link rel="prefetch" href="/assets/js/25.64098a0b.js"><link rel="prefetch" href="/assets/js/26.e2acfd13.js"><link rel="prefetch" href="/assets/js/27.aff06937.js"><link rel="prefetch" href="/assets/js/28.8bc12e94.js"><link rel="prefetch" href="/assets/js/29.c7890b85.js"><link rel="prefetch" href="/assets/js/3.79b6242f.js"><link rel="prefetch" href="/assets/js/30.1c7523a4.js"><link rel="prefetch" href="/assets/js/31.41d153ce.js"><link rel="prefetch" href="/assets/js/32.076ea23e.js"><link rel="prefetch" href="/assets/js/33.4df50c49.js"><link rel="prefetch" href="/assets/js/34.afd39df7.js"><link rel="prefetch" href="/assets/js/35.96ad804d.js"><link rel="prefetch" href="/assets/js/36.4b18f55f.js"><link rel="prefetch" href="/assets/js/37.785cf241.js"><link rel="prefetch" href="/assets/js/39.e0c013ee.js"><link rel="prefetch" href="/assets/js/4.455a7b47.js"><link rel="prefetch" href="/assets/js/40.141dd392.js"><link rel="prefetch" href="/assets/js/41.c0c4f533.js"><link rel="prefetch" href="/assets/js/42.a505c995.js"><link rel="prefetch" href="/assets/js/43.9538af71.js"><link rel="prefetch" href="/assets/js/44.4a09b0cb.js"><link rel="prefetch" href="/assets/js/45.01328d52.js"><link rel="prefetch" href="/assets/js/46.d54fdc6d.js"><link rel="prefetch" href="/assets/js/47.93af6532.js"><link rel="prefetch" href="/assets/js/48.3aecbfc9.js"><link rel="prefetch" href="/assets/js/49.030d249e.js"><link rel="prefetch" href="/assets/js/5.39ac8b79.js"><link rel="prefetch" href="/assets/js/50.830dbfe7.js"><link rel="prefetch" href="/assets/js/51.8883ddf5.js"><link rel="prefetch" href="/assets/js/52.0e11daf2.js"><link rel="prefetch" href="/assets/js/53.fc4fea9f.js"><link rel="prefetch" href="/assets/js/54.224ab9d2.js"><link rel="prefetch" href="/assets/js/55.57f73974.js"><link rel="prefetch" href="/assets/js/56.f67ded59.js"><link rel="prefetch" href="/assets/js/6.53b715ea.js"><link rel="prefetch" href="/assets/js/7.3c48cb9f.js"><link rel="prefetch" href="/assets/js/8.23ab337a.js"><link rel="prefetch" href="/assets/js/9.01843353.js">
    <link rel="stylesheet" href="/assets/css/styles.4c99cee3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Carolina Documentation
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link">Tutorial</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link">Tutorial</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Getting Started</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Framework Overview</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/docs/overview/process.html" class="sidebar-link">Basic Server Process</a></li><li><a href="/docs/overview/service-library.html" class="active sidebar-link">The Carolina Global Object</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/overview/service-library.html#service-registration" class="sidebar-link">Service Registration</a></li><li class="sidebar-sub-header"><a href="/docs/overview/service-library.html#accessing-services" class="sidebar-link">Accessing Services</a></li><li class="sidebar-sub-header"><a href="/docs/overview/service-library.html#the-baseservice-class" class="sidebar-link">The BaseService Class</a></li></ul></li><li><a href="/docs/overview/custom-services.html" class="sidebar-link">Custom Services</a></li><li><a href="/docs/overview/services.html" class="sidebar-link">Framework Services &amp; Class Libraries</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Basics</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Authentication</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Advanced</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Databases</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Included Plugins</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="the-carolina-global-object"><a href="#the-carolina-global-object" aria-hidden="true" class="header-anchor">#</a> The Carolina Global Object</h1><p>The Carolina global object is made global so that you can access configuration
values and Services at runtime.</p><p>Suppose you are writing a Controller and need access to the User Model. Like
all Models classes, the User class is part of a library of Model classes
maintained by the DB Service.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> BaseController <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'carolina/main/http/controllers/base-controller'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyCustomController</span> <span class="token keyword">extends</span> <span class="token class-name">BaseController</span> <span class="token punctuation">{</span>
  
  <span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
    <span class="token keyword">let</span> userId <span class="token operator">=</span> request<span class="token punctuation">.</span>data<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
    
    <span class="token comment">// get DB Service</span>
    <span class="token keyword">let</span> DBSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'DB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// get User model class</span>
    <span class="token keyword">let</span> User <span class="token operator">=</span> DBSvc<span class="token punctuation">.</span><span class="token function">_modelClass</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> userObj <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span>$<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span> _id<span class="token punctuation">:</span> userId <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// more stuff</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Here, we used the Carolina global object to get a reference to the singleton
DB Service, and then used that service to get a reference to the User class.</p><p>All Services are singletons and available via the <code>$</code> method of the
Carolina global object as long as they are properly registered.</p><h2 id="service-registration"><a href="#service-registration" aria-hidden="true" class="header-anchor">#</a> Service Registration</h2><p><strong>Registration In <code>config/app.js</code></strong></p><p>If you look at the file <code>config/app.js</code>, you will notice that the app
configuration object has the <code>services</code> property. It maps names of Services
to the require paths of classes (all of which extend <code>BaseService</code>). Most
of the ones listed in the starter project are built-in services.</p><p>Because the framework relies on the built-in servies having the
proper API, you should leave most of these alone, except for in the case of
DB Service or Session Service - for which you have a few options for which
class you want to use for those Services (more on this topic in a later
section). Because of how this is structured, you could also subclass any
Service class and use that subclass instead, but this will probably not
be necessary. In addition to Carolina built-in services, there is a custom
service that you define, as well as the Services of
two default plugins (Auth and Admin).</p><p>The Carolina global object will read this configuration and keep a map of
Service names to require paths. The first time any given Service is needed,
it is instantiated once, and all subsequent requests for the Service are
answered with the same object.</p><p><strong>Registering Arbitrary Values</strong></p><p>On a topic slightly similar to Services, the Carolina global object has a
propery call <code>values</code>, which is initialized as an empty object. You can
put anything on it to retreive from anywhere else in the application.
There is the getter method <code>value(key, defaultValue)</code> and the setter
method <code>setValue(key, value)</code>.</p><p>Example:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>Carolina<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot;SOME_KEY&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;SOME_VALUE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Later, in another part of the application:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> v <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token string">'SOME_KEY'</span><span class="token punctuation">,</span> <span class="token string">'DEFAULT_VALUE'</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; 'SOME_VALUE'</span>
</code></pre></div><p>It is a good idea to always provide a default when trying to access a value
like this. The default default is <code>null</code>.</p><h2 id="accessing-services"><a href="#accessing-services" aria-hidden="true" class="header-anchor">#</a> Accessing Services</h2><h3 id="lazy-loading"><a href="#lazy-loading" aria-hidden="true" class="header-anchor">#</a> Lazy Loading</h3><p>As mentioned above, Services are only first initialized when they are needed.
For example, the first time some part of you application needs the DB Service,
it is constructed for the first time. At this point all Fields and Model classes
are loaded as well. The next time it is needed, the same DB Service is
available as it is for the rest of application lifecycle.</p><h3 id="service-accessing"><a href="#service-accessing" aria-hidden="true" class="header-anchor">#</a> Service Accessing</h3><p>Accessing a Service is easy. You pass its canonical name to the <code>$(serviceName)</code>
method of the Carolina global object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> EventsSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'Events'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> DBSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'DB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="the-baseservice-class"><a href="#the-baseservice-class" aria-hidden="true" class="header-anchor">#</a> The <code>BaseService</code> Class</h2><p>All Services extend the <code>BaseService</code> class, which is defined in
<code>carolina/services/base-service.js</code>. It carries a few helper methods
as well as the <code>onShutdown()</code> async method which is called for every service
when the application is shut down.</p></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/overview/process.html" class="prev">
          Basic Server Process
        </a></span><span class="next"><a href="/docs/overview/custom-services.html">
          Custom Services
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/app.4c99cee3.js" defer></script><script src="/assets/js/38.8ff035ad.js" defer></script>
  </body>
</html>
