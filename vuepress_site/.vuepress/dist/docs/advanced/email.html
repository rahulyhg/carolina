<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Email | Carolina Documentation</title>
    <meta name="description" content="Documentation for the Carolina web framework.">
    
    
    <link rel="preload" href="/assets/css/styles.4c99cee3.css" as="style"><link rel="preload" href="/assets/js/app.4c99cee3.js" as="script"><link rel="preload" href="/assets/js/4.455a7b47.js" as="script"><link rel="prefetch" href="/assets/js/1.1cf9f1db.js"><link rel="prefetch" href="/assets/js/10.67736b9c.js"><link rel="prefetch" href="/assets/js/11.7beeac27.js"><link rel="prefetch" href="/assets/js/12.8ffce904.js"><link rel="prefetch" href="/assets/js/13.54a86374.js"><link rel="prefetch" href="/assets/js/14.f6222131.js"><link rel="prefetch" href="/assets/js/15.60843f1a.js"><link rel="prefetch" href="/assets/js/16.3bab9827.js"><link rel="prefetch" href="/assets/js/17.371a0e2c.js"><link rel="prefetch" href="/assets/js/18.2bf4752f.js"><link rel="prefetch" href="/assets/js/19.d7b2b433.js"><link rel="prefetch" href="/assets/js/2.d296c8c8.js"><link rel="prefetch" href="/assets/js/20.84f7874a.js"><link rel="prefetch" href="/assets/js/21.b063a67b.js"><link rel="prefetch" href="/assets/js/22.75e8e46c.js"><link rel="prefetch" href="/assets/js/23.c3543ea8.js"><link rel="prefetch" href="/assets/js/24.5c5f18c8.js"><link rel="prefetch" href="/assets/js/25.64098a0b.js"><link rel="prefetch" href="/assets/js/26.e2acfd13.js"><link rel="prefetch" href="/assets/js/27.aff06937.js"><link rel="prefetch" href="/assets/js/28.8bc12e94.js"><link rel="prefetch" href="/assets/js/29.c7890b85.js"><link rel="prefetch" href="/assets/js/3.79b6242f.js"><link rel="prefetch" href="/assets/js/30.1c7523a4.js"><link rel="prefetch" href="/assets/js/31.41d153ce.js"><link rel="prefetch" href="/assets/js/32.076ea23e.js"><link rel="prefetch" href="/assets/js/33.4df50c49.js"><link rel="prefetch" href="/assets/js/34.afd39df7.js"><link rel="prefetch" href="/assets/js/35.96ad804d.js"><link rel="prefetch" href="/assets/js/36.4b18f55f.js"><link rel="prefetch" href="/assets/js/37.785cf241.js"><link rel="prefetch" href="/assets/js/38.8ff035ad.js"><link rel="prefetch" href="/assets/js/39.e0c013ee.js"><link rel="prefetch" href="/assets/js/40.141dd392.js"><link rel="prefetch" href="/assets/js/41.c0c4f533.js"><link rel="prefetch" href="/assets/js/42.a505c995.js"><link rel="prefetch" href="/assets/js/43.9538af71.js"><link rel="prefetch" href="/assets/js/44.4a09b0cb.js"><link rel="prefetch" href="/assets/js/45.01328d52.js"><link rel="prefetch" href="/assets/js/46.d54fdc6d.js"><link rel="prefetch" href="/assets/js/47.93af6532.js"><link rel="prefetch" href="/assets/js/48.3aecbfc9.js"><link rel="prefetch" href="/assets/js/49.030d249e.js"><link rel="prefetch" href="/assets/js/5.39ac8b79.js"><link rel="prefetch" href="/assets/js/50.830dbfe7.js"><link rel="prefetch" href="/assets/js/51.8883ddf5.js"><link rel="prefetch" href="/assets/js/52.0e11daf2.js"><link rel="prefetch" href="/assets/js/53.fc4fea9f.js"><link rel="prefetch" href="/assets/js/54.224ab9d2.js"><link rel="prefetch" href="/assets/js/55.57f73974.js"><link rel="prefetch" href="/assets/js/56.f67ded59.js"><link rel="prefetch" href="/assets/js/6.53b715ea.js"><link rel="prefetch" href="/assets/js/7.3c48cb9f.js"><link rel="prefetch" href="/assets/js/8.23ab337a.js"><link rel="prefetch" href="/assets/js/9.01843353.js">
    <link rel="stylesheet" href="/assets/css/styles.4c99cee3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Carolina Documentation
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link">Tutorial</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><div class="nav-item"><a href="/tutorials/" class="nav-link">Tutorial</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Getting Started</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Framework Overview</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Basics</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Authentication</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Advanced</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/docs/advanced/cli.html" class="sidebar-link">CLI</a></li><li><a href="/docs/advanced/events.html" class="sidebar-link">Events</a></li><li><a href="/docs/advanced/web-sockets.html" class="sidebar-link">Web Sockets</a></li><li><a href="/docs/advanced/files.html" class="sidebar-link">Working with Files</a></li><li><a href="/docs/advanced/email.html" class="active sidebar-link">Email</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/advanced/email.html#configuring-mailers" class="sidebar-link">Configuring Mailers</a></li><li class="sidebar-sub-header"><a href="/docs/advanced/email.html#sending-e-mail" class="sidebar-link">Sending E-Mail</a></li><li class="sidebar-sub-header"><a href="/docs/advanced/email.html#writing-custom-mailers" class="sidebar-link">Writing Custom Mailers</a></li></ul></li><li><a href="/docs/advanced/plugins.html" class="sidebar-link">Plugins</a></li><li><a href="/docs/advanced/jobs.html" class="sidebar-link">Jobs</a></li><li><a href="/docs/advanced/testing.html" class="sidebar-link">Testing</a></li><li><a href="/docs/advanced/requests.html" class="sidebar-link">The Requests Service</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Databases</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Included Plugins</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="email"><a href="#email" aria-hidden="true" class="header-anchor">#</a> Email</h1><p>The Email Service uses a set of mailers (which you configure) in order to send
e-mails. Each mailer is controlled by a driver called a Mailer class. Several
come with the framework.</p><p></p><div class="table-of-contents"><ul><li><a href="#configuring-mailers">Configuring Mailers</a><ul><li><a href="#terminalmailer">TerminalMailer</a></li><li><a href="#filemailer">FileMailer</a></li><li><a href="#mailgunmailer">MailgunMailer</a></li></ul></li><li><a href="#sending-e-mail">Sending E-Mail</a><ul><li><a href="#sending-template-e-mails">Sending Template E-Mails</a></li></ul></li><li><a href="#writing-custom-mailers">Writing Custom Mailers</a></li></ul></div><p></p><h2 id="configuring-mailers"><a href="#configuring-mailers" aria-hidden="true" class="header-anchor">#</a> Configuring Mailers</h2><p>The Email Service is configured by the file <code>config/email.js</code>, which should
contain a <code>mailers</code> property which defines the various mailers that will be used
by your application. You must leave one called &quot;default&quot; in place, but you can
define as many as you like. Every mailer configuration must have a <code>defaultFrom</code>
property (the default FROM e-mail address for all e-mails sent via this mailer)
in addition to a specified <code>driver</code>. Some drivers (Mailer classes) may
take additional configuration properties, as specified in the following
sections.</p><h3 id="terminalmailer"><a href="#terminalmailer" aria-hidden="true" class="header-anchor">#</a><code>TerminalMailer</code></h3><p>The <code>TerminalMailer</code> will &quot;send&quot; e-mails by simplying printing them to the
terminal output. This is the default driver for the default mailer in the
starter project, and can be useful for initial development.</p><p>It is simple to configure:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    driver<span class="token punctuation">:</span> <span class="token string">'TerminalMailer'</span><span class="token punctuation">,</span>
    defaultFrom<span class="token punctuation">:</span> <span class="token string">'webmaster@example.com'</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="filemailer"><a href="#filemailer" aria-hidden="true" class="header-anchor">#</a><code>FileMailer</code></h3><p>The <code>FileMailer</code> is similar to the <code>TerminalMailer</code> in that it is only useful
for initial development. Instead of printing e-mails to the terminal, it writes
them to <code>.txt</code> or <code>.html</code> files with metadata in a corresponding <code>.yml</code> file.
Its configuration should include a <code>basepath</code> property, a path to the directory
where such files should be made. The default value is
<code>&lt;app_dir&gt;/.tmp/mail/</code>.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    driver<span class="token punctuation">:</span> <span class="token string">'FileMailer'</span><span class="token punctuation">,</span>
    defaultFrom<span class="token punctuation">:</span> <span class="token string">'webmaster@example.com'</span><span class="token punctuation">,</span>
    basepath<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'.tmp'</span><span class="token punctuation">,</span> <span class="token string">'mail'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre></div><h3 id="mailgunmailer"><a href="#mailgunmailer" aria-hidden="true" class="header-anchor">#</a><code>MailgunMailer</code></h3><p>The <code>MailgunMailer</code> will send an e-mail using the Mailgun service.
You will need to go to Mailgun and establish a domain and get an API key.
The <code>MailgunMailer</code> is configured this way:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    driver<span class="token punctuation">:</span> <span class="token string">'MailgunMailer'</span><span class="token punctuation">,</span>
    defaultFrom<span class="token punctuation">:</span> <span class="token string">'webmaster@example.com'</span><span class="token punctuation">,</span>
    mailgunApiKey<span class="token punctuation">:</span> <span class="token string">&quot;key-12345&quot;</span><span class="token punctuation">,</span>
    mailgunDomain<span class="token punctuation">:</span> <span class="token string">'example.com'</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="sending-e-mail"><a href="#sending-e-mail" aria-hidden="true" class="header-anchor">#</a> Sending E-Mail</h2><p>The easiest way to send an e-mail is to directly use the Email Service.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> EmailSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'Email'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

EmailSvc<span class="token punctuation">.</span><span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">'webmaster@example.com'</span><span class="token punctuation">,</span>
  to<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'someuser@example.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  subject<span class="token punctuation">:</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span>
  message<span class="token punctuation">:</span> <span class="token string">'I just wanted to say hi.'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>sendEmail</code> method is async and can be awaited. Its first argument is an
object that will be described below. The second argument (which is optional) is
the name of the mailer to use, as defined in <code>config/email.js</code>. If omitted,
the &quot;default&quot; mailer will be used.</p><p>The properties of the object are as follows:</p><ul><li><code>bcc</code>: <em>Optional</em>. <strong>[String,]</strong>. An array of e-mail addresses for the BCC line.</li><li><code>cc</code>: <em>Optional</em>. <strong>[String,]</strong>. An array of e-mail addresses for the CC line.</li><li><code>from</code>: <em>Optional</em>. <strong>String</strong>. The FROM e-mail address. Defaults to the <code>defaultFrom</code> value of the mailer.</li><li><code>isHtml</code><em>Optional</em>. <strong>Boolean</strong>. Whether or not the e-mail should be an HTML e-mail. If <code>true</code>, the <code>message</code> should be valid e-mail HTML. Defaults to <code>false</code>.</li><li><code>message</code>: <strong>String</strong>. The body of the e-mail.</li><li><code>subject</code>: <strong>String</strong>. The subject of the e-mail.</li><li><code>to</code>: <strong>[String,]</strong>. An array of e-mail addresses for the TO line.</li></ul><h3 id="sending-template-e-mails"><a href="#sending-template-e-mails" aria-hidden="true" class="header-anchor">#</a> Sending Template E-Mails</h3><p>Currently, there is support for sending a
<a href="https://www.npmjs.com/package/nunjucks" target="_blank" rel="noopener noreferrer">nunjucks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> template from a file in
your <code>templates/</code> directory. It is recommended that you create a subdirectory
for such templates, such as <code>templates/email/</code>.</p><p>Here is an example template:</p><div class="language- extra-class"><pre class="language-text"><code>Hello {{ username }},

We just wanted to say hi.
</code></pre></div><p>Assuming this is in the file <code>templates/email/hello.txt</code>, you can send an
e-mail using the <code>sendNunjucksTemplate(template, data, obj, mailer='default')</code>
method:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> EmailSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'Email'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

EmailSvc<span class="token punctuation">.</span><span class="token function">sendNunjucksTemplate</span><span class="token punctuation">(</span><span class="token string">'email/hello.txt'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> username<span class="token punctuation">:</span> user<span class="token punctuation">.</span>username <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">'webmaster@example.com'</span><span class="token punctuation">,</span>
    to<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'someuser@example.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    subject<span class="token punctuation">:</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'default'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The first parameter is the
template (relative to <code>templates/</code>) and the second is the data to render the
template with.
The third and fourth parameters are the same as <code>sendEmail</code>, except for
<code>message</code> is ignored. The content of the e-mail will be the result of rendering
the template with the givne data.</p><h2 id="writing-custom-mailers"><a href="#writing-custom-mailers" aria-hidden="true" class="header-anchor">#</a> Writing Custom Mailers</h2><p>If you need to write a different class to handle sending e-mails,
custom mailers can be created very simply.</p><p>You can generate a new Mailer class using the CLI:</p><div class="language- extra-class"><pre class="language-text"><code>node . generate mailer MyCustomMailer
</code></pre></div><p>That would generate the file
<code>site/email/mailers/my-custom-mailer.js</code>.</p><p>The created file will have the <code>sendEmail</code> method stubbed. Within that function
you need to send the e-mail. You don't need to overwrite the <code>BaseMailer</code>
method <code>sendNunjucksTemplate</code>, as it will automatically render a template and
call the <code>sendEmail</code> method.</p><p>You should use the constructor to take the configuration object and do whatever
you need to do.</p><p>Once the custom Mailer is complete, you need to export it in
<code>site/email/mailers/index.js</code>:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * Custom mailers.
 */</span>
exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  MyCustomMailer<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./my-custom-mailer'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>At this point, you would be able to use the custom mailer by specifying it as
the driver for a certain mailer in <code>config/email.js</code>:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    driver<span class="token punctuation">:</span> <span class="token string">'MyCustomMailer'</span><span class="token punctuation">,</span>
    defaultFrom<span class="token punctuation">:</span> <span class="token string">'webmaster@example.com'</span><span class="token punctuation">,</span>
    <span class="token comment">// any other custom configuration you need</span>
  <span class="token punctuation">}</span>
</code></pre></div></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/advanced/files.html" class="prev">
          Working with Files
        </a></span><span class="next"><a href="/docs/advanced/plugins.html">
          Plugins
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/app.4c99cee3.js" defer></script><script src="/assets/js/4.455a7b47.js" defer></script>
  </body>
</html>
