<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CLI | Carolina Documentation</title>
    <meta name="description" content="Documentation for the Carolina web framework.">
    
    
    <link rel="preload" href="/assets/css/styles.1d2d3735.css" as="style"><link rel="preload" href="/assets/js/app.1d2d3735.js" as="script"><link rel="preload" href="/assets/js/3.8f49772c.js" as="script"><link rel="prefetch" href="/assets/js/1.f05c9cba.js"><link rel="prefetch" href="/assets/js/10.bac22d9b.js"><link rel="prefetch" href="/assets/js/11.3d8fb5fe.js"><link rel="prefetch" href="/assets/js/12.15d64a99.js"><link rel="prefetch" href="/assets/js/13.025e71f2.js"><link rel="prefetch" href="/assets/js/14.fd7a08c1.js"><link rel="prefetch" href="/assets/js/15.e1bc1756.js"><link rel="prefetch" href="/assets/js/16.5770cf46.js"><link rel="prefetch" href="/assets/js/17.853ce496.js"><link rel="prefetch" href="/assets/js/18.971e2150.js"><link rel="prefetch" href="/assets/js/19.c761800c.js"><link rel="prefetch" href="/assets/js/2.988f372d.js"><link rel="prefetch" href="/assets/js/20.4e4bef1c.js"><link rel="prefetch" href="/assets/js/21.b3aaaedf.js"><link rel="prefetch" href="/assets/js/22.1bb76f3c.js"><link rel="prefetch" href="/assets/js/23.3d27ba26.js"><link rel="prefetch" href="/assets/js/24.0bac6e09.js"><link rel="prefetch" href="/assets/js/25.c2b28b9a.js"><link rel="prefetch" href="/assets/js/26.0d288857.js"><link rel="prefetch" href="/assets/js/27.98f9eff3.js"><link rel="prefetch" href="/assets/js/28.26974ced.js"><link rel="prefetch" href="/assets/js/29.6b34c182.js"><link rel="prefetch" href="/assets/js/30.3e9f8855.js"><link rel="prefetch" href="/assets/js/31.f88a0e4e.js"><link rel="prefetch" href="/assets/js/32.cd87dfeb.js"><link rel="prefetch" href="/assets/js/33.b61fa559.js"><link rel="prefetch" href="/assets/js/34.c116294f.js"><link rel="prefetch" href="/assets/js/35.2f210b65.js"><link rel="prefetch" href="/assets/js/36.cb8e5677.js"><link rel="prefetch" href="/assets/js/37.0de8ac6f.js"><link rel="prefetch" href="/assets/js/38.cb46e1ce.js"><link rel="prefetch" href="/assets/js/39.b4986129.js"><link rel="prefetch" href="/assets/js/4.6855463a.js"><link rel="prefetch" href="/assets/js/40.a060c3fb.js"><link rel="prefetch" href="/assets/js/41.e48da89d.js"><link rel="prefetch" href="/assets/js/42.3cf3cf2d.js"><link rel="prefetch" href="/assets/js/43.74393af5.js"><link rel="prefetch" href="/assets/js/44.9d05ba51.js"><link rel="prefetch" href="/assets/js/5.00dd7cd0.js"><link rel="prefetch" href="/assets/js/6.9ca81a96.js"><link rel="prefetch" href="/assets/js/7.24dcfe4e.js"><link rel="prefetch" href="/assets/js/8.f67b2fab.js"><link rel="prefetch" href="/assets/js/9.85b5be06.js">
    <link rel="stylesheet" href="/assets/css/styles.1d2d3735.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Carolina Documentation
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Documentation</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Getting Started</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Framework Overview</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Basics</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Authentication</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Advanced</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/docs/advanced/cli.html" class="active sidebar-link">CLI</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/advanced/cli.html#writing-terminal-commands" class="sidebar-link">Writing Terminal Commands</a></li><li class="sidebar-sub-header"><a href="/docs/advanced/cli.html#command-registration" class="sidebar-link">Command Registration</a></li><li class="sidebar-sub-header"><a href="/docs/advanced/cli.html#calling-commands" class="sidebar-link">Calling Commands</a></li></ul></li><li><a href="/docs/advanced/events.html" class="sidebar-link">Events</a></li><li><a href="/docs/advanced/web-sockets.html" class="sidebar-link">Web Sockets</a></li><li><a href="/docs/advanced/files.html" class="sidebar-link">Working with Files</a></li><li><a href="/docs/advanced/email.html" class="sidebar-link">Email</a></li><li><a href="/docs/advanced/plugins.html" class="sidebar-link">Plugins</a></li><li><a href="/docs/advanced/jobs.html" class="sidebar-link">Jobs</a></li><li><a href="/docs/advanced/testing.html" class="sidebar-link">Testing</a></li><li><a href="/docs/advanced/requests.html" class="sidebar-link">The Requests Service</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Databases</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Included Plugins</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h1 id="cli"><a href="#cli" aria-hidden="true" class="header-anchor">#</a> CLI</h1><p>The file <code>index.js</code> in the starter project acts as a command line interface
for your application. Commands for it are managed by the Terminal Service.</p><p>You can access the CLI from the root directory of the starter project by
running <code>node . &lt;command&gt;</code>. For example, to see a list of available commands
along with their descriptions:</p><div class="language- extra-class"><pre class="language-text"><code>node . help
</code></pre></div><p></p><div class="table-of-contents"><ul><li><a href="#writing-terminal-commands">Writing Terminal Commands</a><ul><li><a href="#generating-commands">Generating Commands</a></li><li><a href="#command-logic">Command Logic</a></li><li><a href="#defining-arguments">Defining Arguments</a></li><li><a href="#defining-command-logic">Defining Command Logic</a></li></ul></li><li><a href="#command-registration">Command Registration</a></li><li><a href="#calling-commands">Calling Commands</a></li></ul></div><p></p><p><strong>Aside: Interaction</strong></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>You can interact with an instance of the application as well. If you run
<code>node</code> from the root directory of the starter project, you can
<code>require('./initialize/app')</code> to register the global Carolina object and
access Services as needed.</p></div><h2 id="writing-terminal-commands"><a href="#writing-terminal-commands" aria-hidden="true" class="header-anchor">#</a> Writing Terminal Commands</h2><p>The Terminal Service looks for Commands to be exported by the file
<code>site/terminal/commands/index.js</code>.</p><h3 id="generating-commands"><a href="#generating-commands" aria-hidden="true" class="header-anchor">#</a> Generating Commands</h3><p>You can scaffold a new Command by running:</p><div class="language- extra-class"><pre class="language-text"><code>node . generate command MyNewCommand
</code></pre></div><p>This would create the file
<code>site/temrinal/commands/my-new-command.js</code>. You would still need to alter
<code>site/terminal/commands/index.js</code> to export it by name:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// custom commands</span>
exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  MyNewCommand<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./my-new-command'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="command-logic"><a href="#command-logic" aria-hidden="true" class="header-anchor">#</a> Command Logic</h3><p>Here is a basic example of a Command (with some comments).
This one simply takes a username and
sends a friendly e-mail to the corresponding user.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">FriendlyEmailCommand</span> <span class="token keyword">extends</span> <span class="token class-name">BaseCommand</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// how it will be invoked from the CLI</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>commandName <span class="token operator">=</span> <span class="token string">'friendly-email'</span><span class="token punctuation">;</span>
    <span class="token comment">// help message</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;Sends a friendly e-mail to a user.&quot;</span><span class="token punctuation">;</span>

    <span class="token comment">// the argparse arguments</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        args<span class="token punctuation">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          help<span class="token punctuation">:</span> <span class="token string">&quot;The username of the user to e-mail.&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// actual execution of command</span>
  <span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// user services / other code to do most of the work</span>
    <span class="token keyword">let</span> DBSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'DB'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> EmailSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'Email'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> User <span class="token operator">=</span> DBSvc<span class="token punctuation">.</span><span class="token function">_modelClass</span><span class="token punctuation">(</span><span class="token string">'User'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// args.username available from user input</span>
    <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span>$<span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">{</span> username<span class="token punctuation">:</span> args<span class="token punctuation">.</span>username <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// IRL maybe check if user exists and</span>
    <span class="token comment">// throw error here and/or return 1 if user is null</span>

    <span class="token comment">// prepare and send e-mail</span>
    <span class="token keyword">let</span> <span class="token keyword">from</span> <span class="token operator">=</span> <span class="token string">'webmaster@example.com'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> to <span class="token operator">=</span> <span class="token punctuation">[</span>user<span class="token punctuation">.</span>emailAddress<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> subject <span class="token operator">=</span> <span class="token string">'HELLO!'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token string">`Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!`</span></span><span class="token punctuation">;</span>

    EmailSvc<span class="token punctuation">.</span><span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token keyword">from</span><span class="token punctuation">,</span>
      to<span class="token punctuation">:</span> to<span class="token punctuation">,</span>
      subject<span class="token punctuation">:</span> subject<span class="token punctuation">,</span>
      message<span class="token punctuation">:</span> message
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// return 0 if everything went well</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The <code>handle</code> method will receive the arguments passed at the command line
(more on this below). It will be awaited by the Terminal Service. Once the
Command is complete, the Terminal Service will exit the node process using
the return value as the status code (non-zero status codes are considered
to represent some kind of error).</p><h3 id="defining-arguments"><a href="#defining-arguments" aria-hidden="true" class="header-anchor">#</a> Defining Arguments</h3><p>The arguments that the Command will take at the command line are managed
by the NPM <a href="https://www.npmjs.com/package/argparse" target="_blank" rel="noopener noreferrer">argparse<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> module.</p><p>The short version is that the <code>args</code> property of the Command object should
be a list of objects, each containing the properties <code>arg</code> and <code>options</code>.
Those two values are placed as the first and second arguments
to <code>subparser.addArgument(arg, options)</code> in the <code>argparse</code> library.
The values in the <code>args</code> property of the Command define the type of object
that will be received by the <code>handle</code> method.</p><h4 id="positional-arguments"><a href="#positional-arguments" aria-hidden="true" class="header-anchor">#</a> Positional Arguments</h4><p>Positional arugments look just like the <code>username</code> argument in the example
Command above:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    arg<span class="token punctuation">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      help<span class="token punctuation">:</span> <span class="token string">&quot;The username.&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>If this were the only arg, the command invocation might look like this:</p><div class="language- extra-class"><pre class="language-text"><code>node . command-name admin
</code></pre></div><p>This would result in the following object being passed to the Command's
<code>handle</code> method:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">'admin'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Note the <code>subcommand</code>. It is always there, and will be the command line
name of the
Command. Do not name one of your custom arguments &quot;subcommand&quot;.</p></div><h4 id="flags-and-optional-arguments"><a href="#flags-and-optional-arguments" aria-hidden="true" class="header-anchor">#</a> Flags and Optional Arguments</h4><p>Flags are arguments that are invoked like <code>-f</code> or <code>--flag</code>
(or possibly <code>-f value</code> or <code>--flag value</code>). They come in
two forms: boolean switches and optional arguments.</p><p>Boolean switch arguments are interpreted as true if the flag (like <code>-f</code>)
is present and false otherwise. If you want to make an argument a boolean
switch, set the <code>action</code> property of the options object to <code>storeTrue</code>.</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    arg<span class="token punctuation">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      help<span class="token punctuation">:</span> <span class="token string">&quot;The username.&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    arg<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'-f'</span><span class="token punctuation">,</span> <span class="token string">'--flag'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      action<span class="token punctuation">:</span> <span class="token string">'storeTrue'</span><span class="token punctuation">,</span>
      help<span class="token punctuation">:</span> <span class="token string">&quot;Whether or not flag is true or false.&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>If such a command were invoked like as <code>node . command-name admin</code>, then the
resulting object passed to <code>handle</code> would be:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
  flag<span class="token punctuation">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If the command were <code>node . command-name -f</code> or <code>node . command-name --flag</code>, then
the object would be:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
  flag<span class="token punctuation">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Optional Arguments</strong></p><p>You can have optional arguments of the form <code>-c CC / --cc CC</code> by omitting
the <code>action</code> property of the <code>options</code> object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    arg<span class="token punctuation">:</span> <span class="token string">'username'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      help<span class="token punctuation">:</span> <span class="token string">&quot;The username.&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    arg<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'-c'</span><span class="token punctuation">,</span> <span class="token string">'--cc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      help<span class="token punctuation">:</span> <span class="token string">&quot;Optional other user to courtesy-copy.&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>In this case, the command <code>node . command-name admin</code> would result in the
object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
  cc<span class="token punctuation">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The command <code>node . command-name admin -cc otheruser</code> would result in the
object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  username<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
  cc<span class="token punctuation">:</span> <span class="token string">'otheruser'</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>If <code>null</code> is not what you want if an optional argument is omitted, you can
provide a <code>defaultValue</code> in the <code>options</code> object.</p></div><h4 id="varargs"><a href="#varargs" aria-hidden="true" class="header-anchor">#</a> Varargs</h4><p>Arguments that do not use syntax like <code>-f/--flag</code> are considered positional
arguments. The last or only positional argument can have a <code>nargs</code> property
on the <code>options</code> object. One use case for this is to take an array of values.</p><p>Here is an example:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    arg<span class="token punctuation">:</span> <span class="token string">'usernames'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      nargs<span class="token punctuation">:</span> <span class="token string">'+'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>Using this, the command <code>node . command-name admin</code> would result in the object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  usernames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The command <code>node . command-name admin otheruser yetanotheruser</code> would result
in the object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  usernames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'otheruser'</span><span class="token punctuation">,</span> <span class="token string">'yetanotheruser'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Using the &quot;+&quot; means that at least one must be present, so <code>node . command-name</code>
would fail. If you replace the &quot;+&quot; with &quot;*&quot;, then <code>node . command-name</code> would
result in the object:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  subcommand<span class="token punctuation">:</span> <span class="token string">'command-name'</span><span class="token punctuation">,</span>
  usernames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="defining-command-logic"><a href="#defining-command-logic" aria-hidden="true" class="header-anchor">#</a> Defining Command Logic</h3><p>You define the logic of the command in the <code>handle</code> method. You should
return an integer, preferably 0 if everything goes well and a positive
integer otherwise.</p><h4 id="the-args-object"><a href="#the-args-object" aria-hidden="true" class="header-anchor">#</a> The <code>args</code> Object</h4><p>The object passed into the <code>handle</code> method will be argparsed from whatever
is made at the command line. See the above section for more details on how
to configure this.</p><h4 id="prompting"><a href="#prompting" aria-hidden="true" class="header-anchor">#</a> Prompting</h4><p>The <code>BaseCommand</code> class does not have any special methods for getting user
input interactively, but I recommend the NPM
<a href="https://www.npmjs.com/package/enquirer" target="_blank" rel="noopener noreferrer">enquirer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> module for this purpose.</p><h4 id="output"><a href="#output" aria-hidden="true" class="header-anchor">#</a> Output</h4><p>The <code>BaseCommand</code> class has some methods you can use in your subclass Command
to write input to the console in different colors:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dim</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// writes in gray</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// writes in green</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">blue</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// writes in blue</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// writes in magenta</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// writes in yellow</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">err</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// writes in red</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// boring, equates to console.log</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tables</strong></p><p>The <code>BaseCommand</code> class has a method that uses the NPM
<a href="https://www.npmjs.com/package/table-layout" target="_blank" rel="noopener noreferrer">table-layout<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> module for
displaying tabular data. When you this, the first row the table should be
headers:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> item<span class="token punctuation">:</span> <span class="token string">&quot;ITEM&quot;</span><span class="token punctuation">,</span> cost<span class="token punctuation">:</span> <span class="token string">&quot;COST&quot;</span><span class="token punctuation">,</span> desc<span class="token punctuation">:</span> <span class="token string">&quot;DESC&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> item<span class="token punctuation">:</span> <span class="token string">&quot;Sword&quot;</span><span class="token punctuation">,</span> cost<span class="token punctuation">:</span> <span class="token number">150</span><span class="token punctuation">,</span> desc<span class="token punctuation">:</span> <span class="token string">&quot;Does damage.&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> item<span class="token punctuation">:</span> <span class="token string">&quot;Shield&quot;</span><span class="token punctuation">,</span> cost<span class="token punctuation">:</span> <span class="token number">130</span><span class="token punctuation">,</span> desc<span class="token punctuation">:</span> <span class="token string">&quot;Blocks some damage.&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> item<span class="token punctuation">:</span> <span class="token string">&quot;Potion&quot;</span><span class="token punctuation">,</span> cost<span class="token punctuation">:</span> <span class="token number">60</span><span class="token punctuation">,</span> desc<span class="token punctuation">:</span> <span class="token string">&quot;Restores HP.&quot;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">table</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The output of the above command would be:</p><div class="language- extra-class"><pre class="language-text"><code> ITEM    COST  DESC
 Sword   150   Does damage.
 Shield  130   Blocks some damage.
 Potion  60    Restores HP.
</code></pre></div><p><strong>Progress Bar</strong></p><p>The <code>BaseCommand</code> class has a method that uses the NPM
<a href="https://www.npmjs.com/package/cli-progress" target="_blank" rel="noopener noreferrer">cli-progress<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> module for
showing and updating progress bars:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  
  <span class="token comment">// set bar value at 0 with a max of 100</span>
  <span class="token keyword">let</span> bar <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getProgressBar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">// do something that takes 1% of the work</span>

    bar<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  bar<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token string">&quot;DONE!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="command-registration"><a href="#command-registration" aria-hidden="true" class="header-anchor">#</a> Command Registration</h2><p>To ensure that your command is available to the Terminal Service, ensure
that the class is exported by some name in <code>site/terminal/commands/index.js</code>.</p><p>Example:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// site/terminal/commands/index.js</span>
exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  MyCommand<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./my-command'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="calling-commands"><a href="#calling-commands" aria-hidden="true" class="header-anchor">#</a> Calling Commands</h2><p>You can call other commands by getting them by name from the Terminal Service
and passing appropriate arguments to the <code>handle</code> method.</p><p>Here is an example of a command that mimics evoking
<code>node . create-admin-user -u admin -e admin@example.com</code>,
which is a command from the 'carolina/plugins/admin' plugin:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    
  <span class="token keyword">let</span> TerminalSvc <span class="token operator">=</span> Carolina<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'Terminal'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> createAdminUserCommand <span class="token operator">=</span> TerminalSvc<span class="token punctuation">.</span><span class="token function">_command</span><span class="token punctuation">(</span>
    <span class="token string">'Carolina/Admin/CreateAdminUserCommand'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token keyword">await</span> createAdminUserCommand<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    username<span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
    email<span class="token punctuation">:</span> <span class="token string">'admin@example.com'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/auth/email-verification.html" class="prev">
          E-Mail Verification
        </a></span><span class="next"><a href="/docs/advanced/events.html">
          Events
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/app.1d2d3735.js" defer></script><script src="/assets/js/3.8f49772c.js" defer></script>
  </body>
</html>
