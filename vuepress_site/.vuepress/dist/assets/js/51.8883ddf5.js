(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{136:function(t,s,a){"use strict";a.r(s);var e=a(0),n=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"displaying-tasks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#displaying-tasks","aria-hidden":"true"}},[t._v("#")]),t._v(" Displaying Tasks")]),a("p",[t._v("Now it's time to show the user's items on the main inventory page.")]),a("p",[t._v("The second argument to the "),a("code",[t._v("pugTemplate()")]),t._v(" method of the Base Controller class\nis an object of extra data to be made available to the pug template engine.\nThe goal now is to have the main "),a("code",[t._v("handle()")]),t._v(" method of the "),a("code",[t._v("ItemsController")]),t._v("\nclass get a query of all Items in the database that belong to the current\nuser, and then provide the results to the template.")]),a("p",[t._v("Edit the "),a("code",[t._v("handle")]),t._v(" method to look this this:")]),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handle")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// get the Item class")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" Item "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Carolina"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DB'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("_modelClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// query for items")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" items "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" Item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("$query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_id "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// provide items to the template engine")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("pugTemplate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"items"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" items"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" title"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Inventory"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("Note that the query is based on the ID of the current User. The "),a("code",[t._v("user")]),t._v(' field of\nthe Item class was defined to be a "Ref" field, so the ID is what is actually\nstored and is queryable in the database.')]),a("p",[t._v('The next step is to edit the template to display the data. Replace the\n"TODO" paragraph with the following templating:')]),a("div",{staticClass:"language-pug extra-class"},[a("pre",{pre:!0,attrs:{class:"language-pug"}},[a("code",[t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// add list here")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("br")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("br")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("div.card")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("h5.card-header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Items")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v(".card-body")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("table.table")]),t._v("\n            \n              "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("thead")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("th")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Item")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("th")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Description")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("th")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Delete")]),t._v("\n              \n              "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("tbody")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token flow-control"}},[a("span",{pre:!0,attrs:{class:"token each"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("each")]),t._v(" item "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")])]),t._v(" locals"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("items")]),t._v("\n                  "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("tr")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("td")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token code"}},[t._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("td")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token code"}},[t._v(" item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("description")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token tag"}},[t._v("td")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("DELETE BUTTON (TODO)")]),t._v("\n")])])]),a("p",[t._v("This template iterates over all the items passed to the template engine\nand displays them in a table.")]),a("p",[t._v("Start the server and visit "),a("code",[t._v("http://localhost:8080/items")]),t._v(" and you will see\nthe Items table below the New Item form. Try adding a few items with the\nform and you should see them appear in the table.")])])}],!1,null,null,null);s.default=n.exports}}]);